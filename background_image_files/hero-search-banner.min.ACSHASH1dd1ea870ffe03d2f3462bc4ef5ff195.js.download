(self.webpackChunkaem_maven_archetype=self.webpackChunkaem_maven_archetype||[]).push([[1187],{82835:function(t){function e(t,e,o){var s,a,i,c,n;function r(){var l=Date.now()-c;l<e&&l>=0?s=setTimeout(r,e-l):(s=null,o||(n=t.apply(i,a),i=a=null))}null==e&&(e=100);var l=function(){i=this,a=arguments,c=Date.now();var l=o&&!s;return s||(s=setTimeout(r,e)),l&&(n=t.apply(i,a),i=a=null),n};return l.clear=function(){s&&(clearTimeout(s),s=null)},l.flush=function(){s&&(n=t.apply(i,a),i=a=null,clearTimeout(s),s=null)},l}e.debounce=e,t.exports=e},36211:function(t,e,o){"use strict";o.d(e,{Fz:function(){return l},R3:function(){return u},RK:function(){return r},eD:function(){return p},ih:function(){return h}});var s=o(84684),a=o(16325);const i="bloomreach.analytics.search.event",c="bloomreach.search.data",n="bloomreach.bike.event";function r(t){const e={},o=s.tG.includes(s.bn)?s.bn:"en";e.q=t.trim(),e.catalogs=[{name:`harley_davidson_${o}_products_online`}],sessionStorage.setItem(c,JSON.stringify(e)),window.br_data=window.br_data||{},window.br_data.searchData=e,document.body.dispatchEvent(new CustomEvent(i))}function l(t,e){const o={},a=s.tG.includes(s.bn)?s.bn:"en";o.aq=t.trim(),o.q=e,o.catalogs=[{name:`harley_davidson_${a}_products_online`}],sessionStorage.setItem(c,JSON.stringify(o)),window.br_data=window.br_data||{},window.br_data.searchData=o,document.body.dispatchEvent(new CustomEvent("bloomreach.analytics.suggest.event"))}function u(){sessionStorage.setItem(n,"true");const t=JSON.parse(sessionStorage.getItem(c))||{};t.catalogs=[{name:`harley_davidson_${s.bn}_bikes_online`}],sessionStorage.setItem(c,JSON.stringify(t)),window.br_data=window.br_data||{},window.br_data.searchData=t,document.body.dispatchEvent(new CustomEvent(i))}function h(){const t=JSON.parse(sessionStorage.getItem(c))||{};window.br_data=window.br_data||{},window.br_data.searchData=t,sessionStorage.setItem(n,"false"),window.onload=function(){document.body.dispatchEvent(new CustomEvent("bloomreach.analytics.bike.search.event"))}}async function p(t,e,o){const s={};s.wrid=t.metadata.widget.rid,s.wid=t.metadata.widget.id,s.wty=t.metadata.widget.type,s.item_id=o,await(0,a.AE)(window,"br_data",(t=>!!t)),document.body.dispatchEvent(new CustomEvent(e,{detail:s}))}},185:function(t,e,o){"use strict";var s=o(86316),a=o.n(s),i=o(16325),c=o(84684),n=o(82835),r=o(36211),l=o(18690);(0,i.j2)(".cmp-hero-search-banner",class{constructor(t){this.init(t)}init(t){this.props(t),this.setContentOpacity(),this.categoriesMap={bikes:this.categoryNameBikes,parts:this.categoryNameParts,content:this.categoryNameContent,kids:this.categoryNameKids,"museum-shop":this.categoryNameMuseum,"mens-motorcycle-clothes":this.categoryNameMens,"womens-motorcycle-clothes":this.categoryNameWomens,"goods-gifts":this.categoryNameGoodsGifts,"service-parts":this.categoryNameServiceParts},this.enableSearch&&this.bindEventActions()}setContentOpacity(){this.$content.css("background-color",`rgba(0, 0, 0, ${this.componentOpacity})`)}props(t){this.$el=$(t),this.$content=$(".content",this.$el),this.$autocomplete=$(".cmp-hero-search-banner__autocomplete",this.$el),this.$autocompleteInput=$("input",this.$autocomplete),this.$autocompleteLoading=$(".icon-loading",this.$autocomplete),this.$autocompleteClear=$(".icon-clear",this.$autocomplete),this.localeURL=this.$el.data("country-lang"),this.enableSearch=this.$el.data("enable-search"),this.categoriesFilter=void 0!==this.$el.data("categories")?this.$el.data("categories"):"",this.subcategoriesFilter=void 0!==this.$el.data("subcategories")?this.$el.data("subcategories"):"",this.categoryNameBikes=this.$el.data("pcname-bikes"),this.categoryNameParts=this.$el.data("pcname-parts"),this.categoryNameMens=this.$el.data("pcname-mens"),this.categoryNameWomens=this.$el.data("pcname-womens"),this.categoryNameGoodsGifts=this.$el.data("pcname-goodsgifts"),this.categoryNameContent=this.$el.data("pcname-content"),this.categoryNameKids=this.$el.data("pcname-kids"),this.categoryNameMuseum=this.$el.data("pcname-museum"),this.categoryNameServiceParts=this.$el.data("pcname-service-parts"),this.currentSearchInput="",this.componentOpacity=this.$el.data("opacity")}getResultSet(t){if(t){return t.map(((t,e)=>{let o="";if(t.categoryName&&(o=t.categoryName.split("|")[0]),!o){let e=t.primaryCategoryCode.split("|");const s=this.categoriesFilter?this.categoriesFilter.split("|"):[];s.length>0&&(e=e.filter((t=>s.includes(t)))),0===e.length&&s.length>0&&(e=s),o=this.categoriesMap[e[0]]}return{...t,primaryCategoryNameFormatted:o}}))}return null}getCategories(t){if(t){return t.map((t=>({...t,primaryCategoryName:this.categoriesMap[t.name],primaryCategoryCode:t.name})))}return null}bindEventActions(){this.$autocompleteInput.on("input",(0,n.debounce)(this.handleSearchInputChange.bind(this),300)),this.$autocomplete.on("keydown",(t=>{const e=t.keyCode||t.which,o=!!t.target.closest("input"),s=!!t.target.closest("span.icon-clear"),a=t.target.closest("li"),i=!!a;if(o||s){const a=!!this.$autocompleteResults;if(13===e)if(o){const t=this.$autocompleteInput.val().trim();if(!!t&&t.length>=3){let e=`${this.localeURL}?format=json;i=1;locale=${c.MV};q=${encodeURIComponent(t)};sp_cs=UTF-8`;""!==this.categoriesFilter&&""!==this.subcategoriesFilter?e+=`&q1=${this.categoriesFilter}&x1=primaryCategoryCode&q2=${this.subcategoriesFilter}&x2=superCategoryCodes`:""!==this.categoriesFilter?e+=`&q1=${this.categoriesFilter}&x1=primaryCategoryCode`:""!==this.subcategoriesFilter&&(e+=`&q1=${this.subcategoriesFilter}&x1=primaryCategoryCode`),(0,r.RK)(this.currentSearchInput),window.location.href=e}}else s&&(this.$autocompleteInput.val(""),this.closeAutocompleteListbox(),this.resetAutocompleteListbox());a&&this.$autocompleteResults.length>0&&40===e&&(t.preventDefault(),setTimeout((()=>{this.$autocompleteResults.attr("aria-selected",!1),this.$autocompleteInput.attr("aria-activedescendant",1),this.$autocompleteResults.eq(0).attr("aria-selected",!0).focus()}),1)),9===e&&setTimeout((()=>{$(document.activeElement).is(this.$autocompleteInput)||this.closeAutocompleteListbox()}))}if(i){const o=parseInt($(a).attr("aria-posinset")),s=parseInt($(a).attr("aria-setsize"));if(38===e&&(t.preventDefault(),this.$autocompleteResults.attr("aria-selected",!1),1===o?(this.$autocompleteInput.attr("aria-activedescendant",s),this.$autocompleteResults.eq(s-1).attr("aria-selected",!0).focus()):(this.$autocompleteInput.attr("aria-activedescendant",o-1),this.$autocompleteResults.eq(o-2).attr("aria-selected",!0).focus())),40===e&&(t.preventDefault(),this.$autocompleteResults.attr("aria-selected",!1),o===s?(this.$autocompleteInput.attr("aria-activedescendant",1),this.$autocompleteResults.eq(0).attr("aria-selected",!0).focus()):(this.$autocompleteInput.attr("aria-activedescendant",o+1),this.$autocompleteResults.eq(o).attr("aria-selected",!0).focus())),27===e&&(t.preventDefault(),this.closeAutocompleteListbox(),this.$autocompleteInput.focus()),13===e){this.closeAutocompleteListbox();const t=$(a.getElementsByTagName("a")[0]);t.length>0&&(t.hasClass("autocomplete-option-product")?(0,r.Fz)(this.currentSearchInput,t.data("productName")):(0,r.RK)(this.currentSearchInput),window.location=t.attr("href")),this.$autocompleteInput.focus()}9===e&&this.closeAutocompleteListbox()}})),this.$autocompleteInput.on("blur",(t=>{setTimeout((()=>{const t=$(document.activeElement),e=t.is("a.autocomplete-option"),o=t.is(this.$autocompleteInput),s=t.is(this.$autocompleteClear),a=!!this.$autocompleteListbox;e||(t.parent().is(this.$autocompleteListbox)||o||s?a&&o&&this.openAutocompleteListbox():this.closeAutocompleteListbox())}),300)})),this.$autocompleteInput.on("focus",(()=>{const t=!!this.$autocompleteListbox,e=this.$autocompleteInput.val().trim();t&&e.length>=3&&this.openAutocompleteListbox()})),this.$autocompleteClear.on("click",(t=>{this.$autocompleteInput.val(""),this.closeAutocompleteListbox(),this.resetAutocompleteListbox()}))}bindListboxActions(){this.$autocompleteResults.on("blur",(()=>{setTimeout((()=>{const t=$(document.activeElement),e=t.is(this.$autocompleteInput)&&!0===this.$autocompleteInput.attr("aria-expanded"),o=t.is(this.$autocompleteClear);t.parent().is(this.$autocompleteListbox)||e||o?e&&this.openAutocompleteListbox():this.closeAutocompleteListbox()}))}))}bindOptionClickActions(t){const e=$(".autocomplete-option-product",this.$autocomplete);$(".autocomplete-option-category",this.$autocomplete).on("click",(t=>{const e=$(t.currentTarget).attr("href");(0,r.RK)(this.currentSearchInput),window.location=e})),e.on("click",(t=>{t.preventDefault();const e=$(t.currentTarget),o=e.attr("href");(0,r.Fz)(this.currentSearchInput,e.data("productName")),window.location=o}))}openAutocompleteListbox(){this.$autocompleteResults.attr("aria-selected",!1),this.$autocompleteInput.attr("aria-expanded",!0).attr("aria-activedescendant","").attr("aria-owns","hero-search-banner__autocomplete-results"),this.$autocompleteListbox.removeClass("d-none")}closeAutocompleteListbox(){this.$autocompleteInput.attr("aria-expanded",!1).attr("aria-activedescendant","");!!this.$autocompleteListbox&&(this.$autocompleteResults.attr("aria-selected",!1),this.$autocompleteListbox.addClass("d-none"))}resetAutocompleteListbox(){const t=!!this.$autocompleteListbox;this.currentSearchInput="",t&&this.$autocompleteListbox.replaceWith('<div class="target-autocomplete"></div>')}handleSearchInputChange(){const t=this.$autocompleteInput.val().trim(),e=!!t;if(t.length||this.$autocompleteClear.addClass("d-none"),!e)return this.closeAutocompleteListbox(),void this.resetAutocompleteListbox();if(!(t.length<3)&&e)if(t!==this.currentSearchInput)this.$autocompleteLoading.removeClass("d-none"),this.$autocompleteClear.addClass("d-none"),this.getAutocompleteResults(t);else{!!this.$autocompleteListbox&&this.openAutocompleteListbox()}}async getAutocompleteResults(t){l.Z.getBannerAutocompleteSearch(t,this.categoriesFilter,this.subcategoriesFilter).then((e=>{this.$autocompleteLoading.addClass("d-none"),this.$autocompleteClear.removeClass("d-none");if(!!e.response&&e.response.numFound>0){const o=!!e.facet_counts.facet_fields.primaryCategoryCode?this.getCategories(e.facet_counts.facet_fields.primaryCategoryCode.values):"",s=this.getResultSet(e.response.docs.slice(0,4));this.closeAutocompleteListbox(),this.resetAutocompleteListbox(),this.currentSearchInput=t,this.renderAutocompletListbox(s,o)}else this.closeAutocompleteListbox(),this.resetAutocompleteListbox()})).catch((t=>{console.log(t)}))}renderAutocompletListbox(t,e){const o=this.$el.find("#cmp-hero-search-banner-autocomplete-template").html(),s=a().compile(o,(0,i.Xw)()),n=this.$el.find(".target-autocomplete"),r=s.render({results:t,categories:e,localeURL:this.localeURL,locale:c.MV,size:t.length+e.length,searchTerm:this.currentSearchInput,encodedSearchTerm:encodeURIComponent(this.currentSearchInput)});n.replaceWith(r),this.$autocompleteListbox=$(".cmp-hero-search-banner__autocomplete-results",this.$autocomplete),this.$autocompleteResults=$("li:not(.separator)",this.$autocompleteListbox),this.bindListboxActions(),this.bindOptionClickActions(t),this.openAutocompleteListbox()}})}},function(t){var e;e=185,t(t.s=e)}]);